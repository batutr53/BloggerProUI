@model BloggerProUI.Models.Pagination.PaginatedResultDto<BloggerProUI.Models.Post.PostListDto>
@{
    var currentCategory = ViewBag.CurrentCategory as string;
    var currentTag = ViewBag.CurrentTag as string;
    
    if (!string.IsNullOrEmpty(currentCategory))
    {
        ViewData["Title"] = $"{currentCategory} - Blog";
        ViewData["Description"] = $"{currentCategory} kategorisindeki blog yazı ları. Sanat, tasarım ve fotoğrafçılık hakkında güncel içerikler.";
        ViewData["Keywords"] = $"{currentCategory}, blog, makale, insanlik hallerimiz";
    }
    else if (!string.IsNullOrEmpty(currentTag))
    {
        ViewData["Title"] = $"{currentTag} - Blog";
        ViewData["Description"] = $"{currentTag} etiketindeki blog yazı ları. Sanat, tasarım ve fotoğrafçılık hakkında güncel içerikler.";
        ViewData["Keywords"] = $"{currentTag}, blog, makale, insanlik hallerimiz";
    }
    else
    {
        ViewData["Title"] = "Blog";
        ViewData["Description"] = "insanlikHallerimiz blog sayfası. Sanat, tasarım ve fotoğrafçılık dünyasından güncel içerikler, ilham verici yazı lar ve yaratıcı fikirler.";
        ViewData["Keywords"] = "blog, sanat, tasarım, fotoğrafçılık, yaratıcılık, insanlik hallerimiz";
    }
    
    // Canonical URL
    var canonicalUrl = $"{Context.Request.Scheme}://{Context.Request.Host}/Blog";
    if (!string.IsNullOrEmpty(currentCategory))
    {
        canonicalUrl += $"?category={Uri.EscapeDataString(currentCategory)}";
    }
    else if (!string.IsNullOrEmpty(currentTag))
    {
        canonicalUrl += $"?tag={Uri.EscapeDataString(currentTag)}";
    }
    ViewData["CanonicalUrl"] = canonicalUrl;
    
    // Open Graph
    ViewData["OgTitle"] = ViewData["Title"] + " - insanlikHallerimiz";
    ViewData["OgDescription"] = ViewData["Description"];
    ViewData["OgType"] = "website";
    ViewData["OgUrl"] = canonicalUrl;
    
    // Structured Data will be added via JavaScript
    ViewData["HasStructuredData"] = "true";
}

<!-- Breadcrumb Navigation -->
<nav aria-label="breadcrumb" class="breadcrumb-nav">
    <div class="container">
        <ol class="breadcrumb">
            <li class="breadcrumb-item home-item"><a href="/">Ana Sayfa</a></li>
            <li class="breadcrumb-item"><a href="/Blog">Blog</a></li>
            @if (!string.IsNullOrEmpty(ViewBag.CurrentCategory as string))
            {
                <li class="breadcrumb-item category-item active" aria-current="page">@ViewBag.CurrentCategory</li>
            }
            else if (!string.IsNullOrEmpty(ViewBag.CurrentTag as string))
            {
                <li class="breadcrumb-item category-item active" aria-current="page">@ViewBag.CurrentTag</li>
            }
            else
            {
                <li class="breadcrumb-item active" aria-current="page">Tüm Yazı lar</li>
            }
        </ol>
    </div>
</nav>

<!-- Main Content -->
<main class="content-container">
    <!-- Blog Header -->
    <section class="page-header" style="text-align: center; margin-bottom: 60px;">
        <h1 class="page-title">Blog</h1>
        <p class="page-subtitle">
            @if (!string.IsNullOrEmpty(ViewBag.CurrentCategory as string))
            {
                <text>@ViewBag.CurrentCategory kategorisindeki yazılar</text>
            }
            else if (!string.IsNullOrEmpty(ViewBag.CurrentTag as string))
            {
                <text>@ViewBag.CurrentTag etiketindeki yazılar</text>
            }
            else
            {
                <text>Sanat, tasarım ve fotoğrafçılık dünyasından son yazılar</text>
            }
        </p>
        @if (!string.IsNullOrEmpty(ViewBag.CurrentCategory as string) || !string.IsNullOrEmpty(ViewBag.CurrentTag as string))
        {
            <div style="margin-top: 20px;">
                <a href="@Url.Action("Index")" style="color: #666; text-decoration: none; padding: 8px 16px; border: 1px solid #ddd; border-radius: 4px;">
                    ← Tüm Yazılar
                </a>
            </div>
        }
    </section>

    <!-- Featured Posts Grid -->
    <section>
        <div class="section-header">
            <h2 class="section-title">Öne Çıkan Yazılar</h2>
        </div>
        
        <div class="trending-grid">
            @if (Model?.Items != null && Model.Items.Any())
            {
                @foreach (var post in Model.Items.Take(3))
                {
                    <a href="@Url.Action("Detail", "Blog", new { slug = post.Slug })" class="trending-item">
                        <img src="@(!string.IsNullOrEmpty(post.FeaturedImage) ? post.FeaturedImage : "https://images.unsplash.com/photo-1494790108755-2616c9a7aaa0?ixlib=rb-4.0.3&auto=format&fit=crop&w=435&q=80")" 
                             alt="@post.Title" class="trending-image" loading="lazy">
                        <div class="trending-meta">
                            @if (post.Categories != null && post.Categories.Any())
                            {
                                @string.Join(", ", post.Categories).ToUpper()
                            }
                            else
                            {
                                <text>GENEL</text>
                            }
                            · @(post.PublishDate?.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR")) ?? post.CreatedAt.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR")))
                        </div>
                        <h3 class="trending-title">@post.Title</h3>
                        <div class="trending-author">Yazan: @(post.Author?.Username?.ToUpper() ?? "BİLİNMEYEN")</div>
                    </a>
                }
            }
            else
            {
                <!-- Fallback static content when no posts are available -->
                <a href="#" class="trending-item">
                    <img src="https://images.unsplash.com/photo-1494790108755-2616c9a7aaa0?ixlib=rb-4.0.3&auto=format&fit=crop&w=435&q=80" alt="No Posts" class="trending-image" loading="lazy">
                    <div class="trending-meta">BİLGİ · @DateTime.Now.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR"))</div>
                    <h3 class="trending-title">Henüz yazı bulunmuyor</h3>
                    <div class="trending-author">BloggerPro</div>
                </a>
                <a href="#" class="trending-item">
                    <img src="https://images.unsplash.com/photo-1502920917128-1aa500764cbd?ixlib=rb-4.0.3&auto=format&fit=crop&w=435&q=80" alt="Coming Soon" class="trending-image" loading="lazy">
                    <div class="trending-meta">BİLGİ · @DateTime.Now.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR"))</div>
                    <h3 class="trending-title">İçerik yakında eklenecek</h3>
                    <div class="trending-author">BloggerPro</div>
                </a>
                <a href="#" class="trending-item">
                    <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?ixlib=rb-4.0.3&auto=format&fit=crop&w=435&q=80" alt="Stay Tuned" class="trending-image" loading="lazy">
                    <div class="trending-meta">BİLGİ · @DateTime.Now.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR"))</div>
                    <h3 class="trending-title">Takipte kalın</h3>
                    <div class="trending-author">BloggerPro</div>
                </a>
            }
        </div>
    </section>

    <!-- All Posts Section -->
    <section>
        <div class="section-header">
            <h2 class="section-title">Tüm Yazılar</h2>
        </div>
        
        <div class="latest-layout">
            <div class="articles-left">
                @if (Model?.Items != null && Model.Items.Any())
                {
                    @foreach (var post in Model.Items)
                    {
                        <a href="@Url.Action("Detail", "Blog", new { slug = post.Slug })" class="article-item">
                            <img src="@(!string.IsNullOrEmpty(post.FeaturedImage) ? post.FeaturedImage : "https://images.unsplash.com/photo-1494790108755-2616c9a7aaa0?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80")" 
                                 alt="@post.Title" class="article-image" loading="lazy">
                            <div class="article-content">
                                <div class="article-meta">
                                    @if (post.Categories != null && post.Categories.Any())
                                    {
                                        @string.Join(", ", post.Categories).ToUpper()
                                    }
                                    else
                                    {
                                        <text>GENEL</text>
                                    }
                                    · @(post.PublishDate?.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR")) ?? post.CreatedAt.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR")))
                                </div>
                                <h3 class="article-title">@post.Title</h3>
                                <div class="article-author">Yazan: @(post.Author?.Username?.ToUpper() ?? "BİLİNMEYEN")</div>
                                <p class="article-excerpt">
                                    @if (!string.IsNullOrEmpty(post.Excerpt))
                                    {
                                        @(post.Excerpt.Length > 150 ? post.Excerpt.Substring(0, 150) + "..." : post.Excerpt)
                                    }
                                    else
                                    {
                                        <text>Bu yazının özeti henüz eklenmemiş.</text>
                                    }
                                </p>
                                <div class="article-stats" style="margin-top: 10px; color: #999; font-size: 14px;">
                                    <span style="margin-right: 15px;">👁 @post.ViewCount</span>
                                    <span style="margin-right: 15px;">❤️ @post.LikeCount</span>
                                    <span>💬 @post.CommentCount</span>
                                </div>
                            </div>
                        </a>
                    }
                    
                    <!-- Pagination -->
                    @if (Model.TotalPages > 1)
                    {
                        <div class="pagination-wrapper" style="margin-top: 40px; text-align: center;">
                            <div class="pagination">
                                @if (Model.HasPreviousPage)
                                {
                                    <a href="@Url.Action("Index", new { page = Model.PageNumber - 1 })" class="pagination-btn">‹ Önceki</a>
                                }
                                
                                @for (int i = Math.Max(1, Model.PageNumber - 2); i <= Math.Min(Model.TotalPages, Model.PageNumber + 2); i++)
                                {
                                    if (i == Model.PageNumber)
                                    {
                                        <span class="pagination-current">@i</span>
                                    }
                                    else
                                    {
                                        <a href="@Url.Action("Index", new { page = i })" class="pagination-btn">@i</a>
                                    }
                                }
                                
                                @if (Model.HasNextPage)
                                {
                                    <a href="@Url.Action("Index", new { page = Model.PageNumber + 1 })" class="pagination-btn">Sonraki ›</a>
                                }
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="no-posts" style="text-align: center; padding: 60px 20px; color: #666;">
                        <h3>Henüz yazı bulunmuyor</h3>
                        <p>Blog sayfası yakında içeriklerle doldurulacak.</p>
                    </div>
                }
            </div>
            
            <aside class="sidebar">
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Kategoriler</h3>
                    <ul style="list-style: none; padding: 0;">
                        @if (ViewBag.Categories != null)
                        {
                            var categories = ViewBag.Categories as List<BloggerProUI.Models.Category.CategoryDto>;
                            if (categories != null && categories.Any())
                            {
                                @foreach (var category in categories)
                                {
                                    <li style="margin-bottom: 10px;">
                                        <a href="@Url.Action("Index", new { category = category.Slug })" style="color: #666; text-decoration: none;">
                                            @category.Name
                                        </a>
                                    </li>
                                }
                            }
                            else
                            {
                                <li style="margin-bottom: 10px; color: #999;">Kategori bulunmamaktadır.</li>
                            }
                        }
                        else
                        {
                            <li style="margin-bottom: 10px;"><a href="#" style="color: #666; text-decoration: none;">Fotoğrafçılık</a></li>
                            <li style="margin-bottom: 10px;"><a href="#" style="color: #666; text-decoration: none;">Sanat</a></li>
                            <li style="margin-bottom: 10px;"><a href="#" style="color: #666; text-decoration: none;">Tasarım</a></li>
                            <li style="margin-bottom: 10px;"><a href="#" style="color: #666; text-decoration: none;">Moda</a></li>
                            <li style="margin-bottom: 10px;"><a href="#" style="color: #666; text-decoration: none;">Mimari</a></li>
                            <li style="margin-bottom: 10px;"><a href="#" style="color: #666; text-decoration: none;">Teknoloji</a></li>
                        }
                    </ul>
                </div>
                
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Popüler Etiketler</h3>
                    <div class="tags">
                        @if (ViewBag.Tags != null)
                        {
                            var tags = ViewBag.Tags as List<BloggerProUI.Models.Tag.TagDto>;
                            if (tags != null && tags.Any())
                            {
                                @foreach (var tag in tags)
                                {
                                    <a href="@Url.Action("Index", new { tag = tag.Name })" class="tag">@tag.Name</a>
                                }
                            }
                            else
                            {
                                <span class="tag" style="background: #f0f0f0; color: #999;">Etiket bulunmamaktadır</span>
                            }
                        }
                        else
                        {
                            <a href="#" class="tag">Fotoğrafçılık</a>
                            <a href="#" class="tag">Sanat</a>
                            <a href="#" class="tag">Tasarım</a>
                            <a href="#" class="tag">Moda</a>
                            <a href="#" class="tag">Portre</a>
                            <a href="#" class="tag">Minimalizm</a>
                            <a href="#" class="tag">Modern</a>
                            <a href="#" class="tag">Dijital</a>
                        }
                    </div>
                </div>
                
                <!-- Newsletter Signup -->
                <div class="sidebar-section">
                    <div class="newsletter-sidebar">
                        <h3 class="newsletter-sidebar-title">E-Bülten</h3>
                        <p class="newsletter-sidebar-text">
                            Blog yazılarımızdan haberdar olmak için e-bültenimize abone olun.
                        </p>
                        <div class="newsletter-sidebar-input">
                            <input type="email" placeholder="E-posta adresiniz">
                        </div>
                        <button class="newsletter-sidebar-btn">Abone Ol</button>
                    </div>
                </div>
            </aside>
        </div>
    </section>
</main>
