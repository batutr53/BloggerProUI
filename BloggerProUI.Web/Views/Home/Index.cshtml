@using BloggerProUI.Models.Post
@using BloggerProUI.Models.Category
@using BloggerProUI.Models.Tag
@using BloggerProUI.Models.Pagination
@using BloggerProUI.Models.Comment
@model PaginatedResultDto<PostListDto>

@{
    ViewData["Title"] = "Ana Sayfa";
}

<!-- Main Content -->
<main class="content-container">
    <!-- Featured Article Section -->
    <section class="featured-section">
        @if (Model?.Items?.Any() == true)
        {
            var featuredPost = Model.Items.FirstOrDefault();
            if (featuredPost != null)
            {
                <article class="featured-article">
                    <a href="@Url.Action("Detail", "Blog", new { id = featuredPost.Id })" style="text-decoration: none; color: inherit;">
                        <img src="@(string.IsNullOrEmpty(featuredPost.FeaturedImage) ? "https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?ixlib=rb-4.0.3&auto=format&fit=crop&w=435&q=80" : featuredPost.FeaturedImage)" alt="@featuredPost.Title" class="featured-image" loading="lazy">
                        <div class="featured-meta">@featuredPost.Categories?.FirstOrDefault()?.ToUpper() • @featuredPost.CreatedAt.ToString("dd MMMM yyyy")</div>
                        <h1 class="featured-title">@featuredPost.Title</h1>
                        <div class="featured-author">Yazan: @featuredPost.Author?.DisplayName?.ToUpper()</div>
                        <p class="featured-excerpt">
                            @Html.Raw(featuredPost.Content)
                        </p>
                    </a>
                </article>
            }
        }
        else
        {
          
        }
        
        <aside class="sidebar">
            @if (Model?.Items?.Count() > 1)
            {
                @foreach (var sidebarPost in Model.Items.Skip(1).Take(3))
                {
                    <a href="@Url.Action("Detail", "Blog", new { id = sidebarPost.Id })" class="sidebar-article">
                        <img src="@(string.IsNullOrEmpty(sidebarPost.FeaturedImage) ? "https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?ixlib=rb-4.0.3&auto=format&fit=crop&w=435&q=80" : sidebarPost.FeaturedImage)" alt="@sidebarPost.Title" class="sidebar-image" loading="lazy">
                        <div class="sidebar-meta">@sidebarPost.Categories?.FirstOrDefault()?.ToUpper() • @sidebarPost.CreatedAt.ToString("dd MMMM yyyy")</div>
                        <h3 class="sidebar-title">@sidebarPost.Title</h3>
                        <div class="sidebar-author">Yazan: @sidebarPost.Author?.DisplayName?.ToUpper()</div>
                        <p class="sidebar-excerpt">
                            @(sidebarPost.Excerpt?.Length > 100 ? sidebarPost.Excerpt.Substring(0, 100) + "..." : sidebarPost.Excerpt)
                        </p>
                    </a>
                }
            }
            else
            {
              
            }
        </aside>
    </section>

    <!-- Today's Trending Section -->
    <section>
        <div class="section-header">
            <h2 class="section-title">Bugünün Öne Çıkanları</h2>
            <a href="@Url.Action("Index", "Blog")" class="view-all">Tümünü Gör</a>
        </div>
        
        <div class="trending-grid">
            @if (ViewBag.FeaturedPosts != null)
            {
                var featuredPosts = ViewBag.FeaturedPosts as List<PostListDto>;
                if (featuredPosts != null && featuredPosts.Any())
                {
                    @foreach (var trendingPost in featuredPosts)
                    {
                        <a href="@Url.Action("Detail", "Blog", new { id = trendingPost.Id })" class="trending-item">
                            <img src="@(string.IsNullOrEmpty(trendingPost.FeaturedImage) ? "https://images.unsplash.com/photo-1502920917128-1aa500764cbd?ixlib=rb-4.0.3&auto=format&fit=crop&w=435&q=80" : trendingPost.FeaturedImage)" alt="@trendingPost.Title" class="trending-image" loading="lazy">
                            <div class="trending-meta">@trendingPost.Categories?.FirstOrDefault()?.ToUpper() • @trendingPost.CreatedAt.ToString("dd MMMM yyyy")</div>
                            <h3 class="trending-title">@trendingPost.Title</h3>
                            <div class="trending-author">Yazan: @trendingPost.Author?.DisplayName?.ToUpper()</div>
                        </a>
                    }
                }
            }
            else
            {
              
            }
        </div>
    </section>

    <!-- Latest Articles Section -->
    <section>
        <div class="section-header">
            <h2 class="section-title">Son Yazılar</h2>
            <a href="@Url.Action("Index", "Blog")" class="view-all">Tümünü Gör</a>
        </div>
        
        <div class="latest-layout">
            <div class="articles-left">
                @if (Model?.Items?.Count() > 7)
                {
                    @foreach (var latestPost in Model.Items.Skip(7).Take(3))
                    {
                        <a href="@Url.Action("Detail", "Blog", new { id = latestPost.Id })" class="article-item">
                            <img src="@(string.IsNullOrEmpty(latestPost.FeaturedImage) ? "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80" : latestPost.FeaturedImage)" alt="@latestPost.Title" class="article-image" loading="lazy">
                            <div class="article-content">
                                <div class="article-meta">@latestPost.Categories?.FirstOrDefault()?.ToUpper() • @latestPost.CreatedAt.ToString("dd MMMM yyyy")</div>
                                <h3 class="article-title">@latestPost.Title</h3>
                                <div class="article-author">Yazan: @latestPost.Author?.DisplayName?.ToUpper()</div>
                                <p class="article-excerpt">
                                    @(latestPost.Excerpt?.Length > 150 ? latestPost.Excerpt.Substring(0, 150) + "..." : latestPost.Excerpt)
                                </p>
                            </div>
                        </a>
                    }
                }
                else
                {
                   
                }
            </div>
            
            <aside class="sidebar">
                <a href="#" class="sidebar-article">
                    <img src="https://images.unsplash.com/photo-1524985069026-dd778a71c7b4?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80" alt="Editor's Pick" class="sidebar-image" loading="lazy">
                    <div class="sidebar-meta">EDİTÖRÜN SEÇİMİ • 15 Ocak 2025</div>
                    <h3 class="sidebar-title">Yılın Fotoğraf Sergisi</h3>
                    <div class="sidebar-author">Yazan: EDİTÖR</div>
                    <p class="sidebar-excerpt">
                        Bu yılın en etkileyici fotoğraf sergilerinden birini 
                        kaçırmayın...
                    </p>
                </a>
                
                <a href="#" class="sidebar-article">
                    <img src="https://images.unsplash.com/photo-1541961017774-22349e4a1262?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80" alt="Popular Article" class="sidebar-image" loading="lazy">
                    <div class="sidebar-meta">POPÜLER • 14 Ocak 2025</div>
                    <h3 class="sidebar-title">En Çok Okunan Makale</h3>
                    <div class="sidebar-author">Yazan: TEAM</div>
                    <p class="sidebar-excerpt">
                        Okuyucularımızın en çok ilgi gösterdiği 
                        içeriklerden biri...
                    </p>
                </a>
            </aside>
        </div>
    </section>

    <!-- Latest Comments Section -->
    <section>
        <div class="section-header">
            <h2 class="section-title">Son Yorumlar</h2>
            <a href="@Url.Action("Index", "Blog")" class="view-all">Tümünü Gör</a>
        </div>
        
        <div class="articles-left">
            @if (ViewBag.RecentComments != null)
            {
                var recentComments = ViewBag.RecentComments as List<BloggerProUI.Models.Comment.RecentCommentDto>;
                if (recentComments != null && recentComments.Any())
                {
                    @foreach (var comment in recentComments)
                    {
                        <div class="podcast-item" style="display: flex; border-bottom: 1px solid #eee; padding-bottom: 20px; margin-bottom: 20px;">
                            <div class="podcast-image" style="position: relative; width: 100px; height: 100px; overflow: hidden; flex-shrink: 0; border-radius: 8px;">
                                <a href="@Url.Action("Detail", "Blog", new { slug = comment.Post.Slug })">
                                    <img src="@(string.IsNullOrEmpty(comment.Post.ImageUrl) ? "https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80" : comment.Post.ImageUrl)" alt="@comment.Post.Title" style="width: 100%; height: 100%; object-fit: cover;">
                                </a>
                            </div>
                            <div class="podcast-content" style="flex: 1; margin-left: 15px;">
                                <h3 class="podcast-title" style="font-size: 16px; margin: 0 0 8px 0;">
                                    <a href="@Url.Action("Detail", "Blog", new { slug = comment.Post.Slug })" style="color: #333; text-decoration: none;">
                                        @comment.Post.Title
                                    </a>
                                </h3>
                                <div class="podcast-meta" style="color: #666; font-size: 14px; margin-bottom: 8px;">
                                    @comment.UserName • @comment.CreatedAt.ToString("dd MMMM yyyy")
                                </div>
                                <p class="podcast-description" style="color: #666; font-size: 14px; line-height: 1.4; margin: 0;">
                                    @(comment.Content.Length > 120 ? comment.Content.Substring(0, 120) + "..." : comment.Content)
                                </p>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="podcast-item" style="text-align: center; padding: 40px 20px; color: #666;">
                        <div class="podcast-image" style="position: relative; margin: 0 auto 20px; width: 80px; height: 80px;">
                            <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80" alt="No Comments" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">
                        </div>
                        <div class="podcast-content">
                            <div class="podcast-meta">BİLGİ • @DateTime.Now.ToString("dd MMMM yyyy")</div>
                            <h3 class="podcast-title">Henüz Yorum Bulunmuyor</h3>
                            <div class="article-author">BloggerPro</div>
                            <p class="podcast-description">
                                Blog yazılarına yapılan yorumlar burada görüntülenecektir.
                                İlk yorumu siz yapın!
                            </p>
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="podcast-item" style="text-align: center; padding: 40px 20px; color: #666;">
                    <div class="podcast-image" style="position: relative; margin: 0 auto 20px; width: 80px; height: 80px;">
                        <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80" alt="Loading" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">
                    </div>
                    <div class="podcast-content">
                        <div class="podcast-meta">YÜKLENIYOR • @DateTime.Now.ToString("dd MMMM yyyy")</div>
                        <h3 class="podcast-title">Yorumlar Yükleniyor</h3>
                        <div class="article-author">BloggerPro</div>
                        <p class="podcast-description">
                            Son yorumlar yükleniyor...
                        </p>
                    </div>
                </div>
            }
        </div>
    </section>
</main>

<!-- Newsletter Section -->
<section class="newsletter-section">
    <h2 class="newsletter-title">Daha Fazlası İçin Abone Olun</h2>
    <p class="newsletter-description">
        Sanat, tasarım ve fotoğrafçılık dünyasından en güncel haberler, 
        özel içerikler ve eksklüzif röportajlar için e-bültenimize katılın.
    </p>
    
    <div class="newsletter-buttons">
        <div class="newsletter-input">
            <input type="email" placeholder="E-posta adresiniz" name="newsletter-email">
            <button type="button">Abone Ol</button>
        </div>
    </div>
</section>

@if (Model?.TotalPages > 1)
{
    <div class="pagination-container" style="text-align: center; margin: 40px 0;">
        <div class="pagination">
            @if (Model.PageNumber > 1)
            {
                <a href="@Url.Action("Index", new { page = Model.PageNumber - 1, pageSize = Model.PageSize })" class="pagination-btn">← Önceki</a>
            }
            
            @for (int i = 1; i <= Model.TotalPages; i++)
            {
                if (i == Model.PageNumber)
                {
                    <span class="pagination-current">@i</span>
                }
                else
                {
                    <a href="@Url.Action("Index", new { page = i, pageSize = Model.PageSize })" class="pagination-btn">@i</a>
                }
            }
            
            @if (Model.PageNumber < Model.TotalPages)
            {
                <a href="@Url.Action("Index", new { page = Model.PageNumber + 1, pageSize = Model.PageSize })" class="pagination-btn">Sonraki →</a>
            }
        </div>
    </div>
}